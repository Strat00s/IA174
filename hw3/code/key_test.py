from api_calls import APICall
from ec import Mod, compress

p = 0x586be5268256ae12d62631efc2784d02dcff420d262da9cd94c62d5808bee24d


x_ori = 11253737311805310201712021750167049282416832145806005333050722521427076474569
y_ori = 14314894796979960417397376206802745975552465655736319691232702477663402075062

x_pre = 11248116353149380985927843528280793671594916393333454353417518141283646579667
y_pre = 29612834194426065668798480166312539171658933489371776557829630010019585637575


data = {"x": f"{hex(x_ori)}", "y": f"{hex(y_ori)}"}
response = APICall("easy", "ecdh", "492875", data)
if response == None:
    exit()

secret = response["secret"]

print(f"Prediction: {compress((Mod(x_pre, p), Mod(y_pre, p)))}")
print(f"secret:     {secret}")