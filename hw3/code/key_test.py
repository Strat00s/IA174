from api_calls import APICall
from ec import Mod, compress

p = 0x586be5268256ae12d62631efc2784d02dcff420d262da9cd94c62d5808bee24d


x_ori = 14578974122320082914186885720932800897890420361766863885599848871889924889920
y_ori = 843837683489338678489293316968743839486206791880048206667544166304472500145

x_pre = 6004343222467853776821698980273441649946441447485443494409447339278919126421
y_pre = 22262176635790928912284173177210334311060962100704447355755030897191128985073


data = {"x": f"{hex(x_ori)}", "y": f"{hex(y_ori)}"}
response = APICall("easy", "ecdh", "492875", data)
if response == None:
    exit()

secret = response["secret"]

print(f"Prediction: {compress((Mod(x_pre, p), Mod(y_pre, p)))}")
print(f"secret:     {secret}")